---
layout: post
title: 目标检测Two-Stage算法解析
date: 2025-09-21 12:30:00
description: Two-Stage目标检测算法详细解析，包括R-CNN、SPP-Net、Fast R-CNN、Faster R-CNN及R-FCN的网络结构、处理流程与优化策略。
thumbnail: /assets/img/blogs/twostage/cover.jpg
tags: [计算机视觉, 目标检测, R-CNN, SPP-Net, Fast R-CNN, Faster R-CNN, R-FCN]
categories: 研究笔记
---

在目标检测的发展脉络中，**Two-Stage算法**起到了奠基作用。  
它的核心思想是**先生成候选区域（Region Proposal）**，再对候选区域进行分类与边框回归。相比传统滑动窗口和选择性搜索方法，Two-Stage算法在精度上有明显提升，但也引入了计算复杂度和处理流程复杂的问题。

接下来，我们详细梳理这一类方法的发展历程，从 R-CNN 到 R-FCN。

---

#### **📌 R-CNN（Regions with CNN features）**

- **步骤**：
  1. 使用 **选择性搜索**生成候选区域（ROI）  
  2. 对每个候选区域裁剪、缩放后送入 CNN 提取特征  
  3. 使用 SVM 分类器判断目标类别  

- **问题**：
  - 候选框数量多且存在重叠 → 计算量大  
  - 各步骤独立 → 测试繁杂，效率低  

> R-CNN虽然开创了候选区域+CNN特征提取的先例，但计算瓶颈明显。

---

#### **📌 SPP-Net（Spatial Pyramid Pooling Network）**

- **目标**：解决 CNN 全连接层对输入尺寸固定的限制  
- **核心改进**：
  - 使用 **SPP（空间金字塔池化）** 对卷积特征图进行多尺度池化  
  - 生成固定长度特征向量，无需对每个候选框进行裁剪缩放  

<div style="text-align:center">
  <img src="/assets/img/blogs/twostage/spp_net.jpeg" alt="SPP-Net流程" style="max-width:85%; height:auto;">
</div>

- **处理流程**：
  1. 全图输入 CNN 提取特征  
  2. 在特征图中定位每个候选框  
  3. SPP 池化 → 分类与边框回归  

> SPP-Net极大提升了计算效率和灵活性。

---

#### **📌 Fast R-CNN**

- **改进点**：
  - 引入 **ROI Pooling**，将候选区域池化到固定尺寸 h×w  
  - 统一 **多任务损失函数**，同时优化分类与边框回归  

- **处理流程**：
  1. 全图特征提取  
  2. 将候选框映射到特征图 → ROI Pooling  
  3. 全连接层 → Softmax 分类 + 边框回归  

> ROI Pooling 解决了 R-CNN 对每个候选框单独 CNN 的冗余问题。

---

#### **📌 Faster R-CNN**

- **核心创新**：提出 **RPN（Region Proposal Network）** 生成候选框  
- **处理步骤**：
  1. **卷积层**：多层卷积提取全图特征  
  2. **RPN层**：
     - 对每个 anchor 判断是否含物体（二分类）  
     - 用 **bounding box regression** 调整位置生成 proposals  
  3. **ROI Pooling**：调整特征维度  
  4. **分类层**：分类 + 回归分支，选择概率最高的类别，再进行精细回归  

> Faster R-CNN 实现了候选区域生成和检测器的端到端融合，大幅提升效率。

---

#### **📌 R-FCN（Region-based Fully Convolutional Network）**

- **背景**：传统分类网络不关注目标精确位置，检测任务需要位置敏感  
- **创新点**：**Position-Sensitive Score Maps**  

- **处理流程**：
  1. 特征提取：ResNet-101 卷积层 + 全连接层  
  2. 通道变换：卷积生成 k²*(C+1) 通道（k×k 网格 + 类别 + 背景）  
  3. ROI划分：候选框划分成 k×k 网格 → 对应通道池化 → 得分矩阵  
  4. 得分聚合：对每类的 k×k 得分矩阵求平均 → 判定类别  

> R-FCN 保留全卷积特征提取效率，同时对目标位置敏感度高，兼顾速度与精度。

---

> **总结**：Two-Stage目标检测方法从 R-CNN 开始，经历 SPP-Net、Fast R-CNN、Faster R-CNN 到 R-FCN 的演进，逐步解决了候选框生成、CNN特征提取和 ROI 池化的问题，实现了**更高精度、更高效率和位置敏感性的目标检测**。

---

<div class="post-navigation" style="margin-top:2rem; padding-top:1rem; border-top:1px solid #eaeaea;">
  <p style="margin-bottom:0.5rem; font-weight:600;">📖 系列文章导航</p>
  <ul style="list-style:none; padding-left:0;">
    <li>⬅️ 上一篇：<a href="{{ '/blog/2025/detection-intro' | relative_url }}">目标检测——SSD单阶段检测器解析</a></li>
    <li>➡️ 下一篇：<a href="{{ '/blog/2025/ssd' | relative_url }}">多模态视觉大模型解析——SAM</a></li>
  </ul>
</div>